<div class="entry">
  <div class="row">
	<% if (item.feature ) { %>
           <% if (config.post_asset_folder){ %>
  	      <div class="thumbnail"><a href="<%- config.root %><%= item.path %>"><img src="<%= item.path %><%= item.feature %>" alt="<%= item.title %>"  class="nofancybox"></a>
           <% } else { %>
              <div class="thumbnail"><a href="<%- config.root %><%= item.path %>"><img src="<%= item.feature %>" alt="<%= item.title %>"  class="nofancybox"></a>
           <% } %>
		</div>
	<% } %>
    <% 
      var truncateLength = 230;
      var showMoreBtn = false;
      var showContent = '';
      var excerptEllipsis = ''; // 定义缺省标识变量

      // 1. 强制兜底获取内容
      var rawContent = item.excerpt || item.content || '';
      var isHomePage = index || (page.type === 'index') || (page.type === 'archive');

      if (isHomePage) { // 主页逻辑
        showContent = rawContent;
        // 判断是否需要显示缺省标识和按钮
        if (item.excerpt && item.content.length > item.excerpt.length) {
          showMoreBtn = true;
          // 内容被手动截断，添加换行缺省标识
          excerptEllipsis = '<span class="excerpt-ellipsis">...</span>';
        } else if (!item.excerpt && rawContent.length > truncateLength) {
          showMoreBtn = true;
          // 内容被自动截断，先截取再添加缺省标识
          showContent = rawContent.substring(0, truncateLength);
          excerptEllipsis = '<span class="excerpt-ellipsis">...</span>';
        }
        // 拼接内容和缺省标识（关键：确保 ... 在内容末尾换行显示）
        showContent += excerptEllipsis;
      } else { // 详情页逻辑
        showContent = item.content || '';
        showMoreBtn = false;
      }

      // 最终兜底
      if (!showContent || showContent.length === 0) {
        showContent = '<p>这个博主很懒，居然新建文件就不管了，哼(๑•̀ㅂ•́)...</p>';
      }
    %>
    <!-- 渲染内容 + 缺省标识 -->
    <%- showContent %>
	</div>
  
  <!-- 保留按钮逻辑 -->
  <% if (showMoreBtn) { %>
    <a type="button" href="<%- config.root %><%- item.path %>" class="btn btn-default more"><%= __('read_more') %></a>
  <% } %>
</div>